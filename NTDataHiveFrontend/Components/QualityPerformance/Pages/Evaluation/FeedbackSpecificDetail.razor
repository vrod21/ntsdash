@using Microsoft.AspNetCore.Authorization

@attribute [Authorize]
@rendermode InteractiveServer
@inject NTDataHiveFrontend.ServiceAccess.EvaluationBackendService MyBackendService
@inject IConfiguration Configuration
@inject NavigationManager MyNavigationManager
@page "/feedback-specific-detail-page/{id:guid}/random"

<style>
    form .row {
        margin-bottom: 16px;
    }
</style>

<div class="create-feedback-button">
    <RadzenButton Style="background-color: #e81f4b;" Click="@Save" Text="Save Feedback" />
</div>

<h3>Feedback Specific Detail</h3>

@if (feedbackDetail == null)
{
    <p><em>Loading...</em></p>
}
else
{
    <EditForm Model="feedbackDetail">
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-6">
                    <RadzenFieldset class="rz-color-white " Text="Feedback">
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Supplier Name" />
                            </div>
                            <div class="col-md-8">
                                <RadzenTextBox Style="width: 100%;" @bind-value="feedbackDetail.SupplierName" Placeholder="Supplier Name" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="QA Name" />
                            </div>
                            <div class="col-md-8">
                                <RadzenTextBox Style="width: 100%;" @bind-value="feedbackDetail.QualityAssurance" Placeholder="Quality Assurance Name" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Publisher Name" />

                            </div>
                            <div class="col-md-8">
                                <RadzenTextBox Style="width: 100%;" @bind-value="feedbackDetail.PublisherName" Placeholder="Publisher Name" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Journal ID" />
                            </div>
                            <div class="col-md-8">
                                <RadzenTextBox Style="width: 100%;" @bind-value="feedbackDetail.JournalId" Placeholder="Journal ID" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Article ID" />
                            </div>
                            <div class="col-md-8">
                                <RadzenTextBox Style="width: 100%;" @bind-value="feedbackDetail.ArticleId" Placeholder="Article ID" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Copy Edited By" />
                            </div>
                            <div class="col-md-8">
                                <RadzenTextBox Style="width: 100%;" @bind-value="feedbackDetail.CopyEditedBy" Placeholder="Copy Edited By" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Page Count" />
                            </div>
                            <div class="col-md-8">
                                <RadzenNumeric Style="width: 100%;" @bind-Value="feedbackDetail.PageCount" TValue="double" Placeholder="Page Count" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Error Count" />
                            </div>
                            <div class="col-md-8">
                                <RadzenNumeric Style="width: 100%;" @bind-value="feedbackDetail.ErrorCount" TValue="double" Placeholder="Error Count" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Description of Error" />
                            </div>
                            <div class="col-md-8">
                                <RadzenTextArea Style="width: 100%;" @bind-value="feedbackDetail.DescriptionOfError" Placeholder="Description of Error" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Matter" />
                            </div>
                            <div class="col-md-8">
                                <RadzenTextBox Style="width: 100%;" @bind-Value="feedbackDetail.Matter" Placeholder="FM/Non-FM" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Error Location" />
                            </div>
                            <div class="col-md-8">
                                <RadzenTextBox Style="width: 100%;" @bind-Value="feedbackDetail.ErrorLocation" Placeholder="Error Location" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Error Code" />
                            </div>
                            <div class="col-md-8">
                                <RadzenTextBox Style="width: 100%;" @bind-Value="feedbackDetail.ErrorCode" Placeholder="Error Code" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Error Type" />
                            </div>
                            <div class="col-md-8">
                                <RadzenTextBox Style="width: 100%;" @bind-Value="feedbackDetail.ErrorType" Placeholder="Error Type" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Error SubType" />
                            </div>
                            <div class="col-md-8">
                                <RadzenTextBox Style="width: 100%;" @bind-Value="feedbackDetail.ErrorSubtype" Placeholder="Error SubType" />
                            </div>
                        </div>

                    </RadzenFieldset>
                </div>
                <div class="col-md-6">
                    <RadzenFieldset class="rz-color-white" Text="Feedback">
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Error Category" />
                            </div>
                            <div class="col-md-8">
                                <RadzenTextBox Style="width: 100%;" @bind-Value="feedbackDetail.ErrorCategory" Placeholder="Error Category" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Introduced/Missed" />
                            </div>
                            <div class="col-md-8">
                                <RadzenTextBox Style="width: 100%;" @bind-Value="feedbackDetail.IntroducedOrMissed" Placeholder="Introduced/Missed" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Department" />
                            </div>
                            <div class="col-md-8">
                                <RadzenTextBox Style="width: 100%;" @bind-Value="feedbackDetail.Department" Placeholder="Department" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Employee Name" />
                            </div>
                            <div class="col-md-8">
                                <RadzenTextBox Style="width: 100%;" @bind-Value="feedbackDetail.EmployeeName" Placeholder="Employee Name" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Root Cause" />
                            </div>
                            <div class="col-md-8">
                                <RadzenTextBox Style="width: 100%;" @bind-Value="feedbackDetail.RootCause" Placeholder="Root Cause" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Corrective Action" />
                            </div>
                            <div class="col-md-8">
                                <RadzenTextBox Style="width: 100%;" @bind-Value="feedbackDetail.CorrectiveAction" Placeholder="Corrective Action" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Nature of CA" />
                            </div>
                            <div class="col-md-8">
                                <RadzenTextBox Style="width: 100%;" @bind-Value="feedbackDetail.NatureOfCA" Placeholder="Nature of CA" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Owner of CA" />
                            </div>
                            <div class="col-md-8">
                                <RadzenTextBox Style="width: 100%;" @bind-Value="feedbackDetail.OwnerOfCA" Placeholder="Owner of CA" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Target Date (CA)" />
                            </div>
                            <div class="col-md-8">
                                <RadzenDatePicker Style="width: 53%;" class="datepicker" @bind-Value="feedbackDetail.TargetDateOfCompletionCA" YearRange="@("2023:" + @DateTime.Now.Year.ToString())"
                                                  DateFormat="MM/dd/yyyy" Placeholder="12/25/2023" Change="@(args => StateHasChanged() )" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Preventive Measure" />
                            </div>
                            <div class="col-md-8">
                                <RadzenTextBox Style="width: 100%;" @bind-Value="feedbackDetail.PreventiveMeasure" Placeholder="Preventive Measure" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Nature of PM" />
                            </div>
                            <div class="col-md-8">
                                <RadzenTextBox Style="width: 100%;" @bind-Value="feedbackDetail.NatureOfPM" Placeholder="Nature of PM" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Owner of PM" />
                            </div>
                            <div class="col-md-8">
                                <RadzenTextBox Style="width: 100%;" @bind-Value="feedbackDetail.OwnerOfPM" Placeholder="Owner of PM" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Target Date (PM)" />
                            </div>
                            <div class="col-md-8">
                                <RadzenDatePicker Style="width: 53%;" class="datepicker" @bind-Value="feedbackDetail.TargetDateOfCompletionPM" YearRange="@("2023:" + @DateTime.Now.Year.ToString())"
                                                  DateFormat="MM/dd/yyyy" Placeholder="12/25/2023" Change="@(args => StateHasChanged())" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Status of CA" />
                            </div>
                            <div class="col-md-8">
                                <RadzenTextBox Style="width: 100%;" @bind-Value="feedbackDetail.StatusOfCA" Placeholder="Status of CA" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Status of PM" />
                            </div>
                            <div class="col-md-8">
                                <RadzenTextBox Style="width: 100%;" @bind-Value="feedbackDetail.StatusOfPM" Placeholder="Status of PM" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="CE Level" />
                            </div>
                            <div class="col-md-8">
                                <RadzenTextBox Style="width: 100%;" @bind-Value="feedbackDetail.CopyEditingLevel" Placeholder="Copy Editing Level" />
                            </div>
                        </div>
@*                         <div class="row">
                            <div class="col-md-3 align-items-center d-flex">
                                <RadzenLabel Text="Time Created" />
                            </div>
                            <div class="col-md-8">
                                <RadzenDatePicker Style="width: 53%;" class="datepicker" @bind-Value="feedbackDetail.CreatedAt" YearRange="@("2023:" + @DateTime.Now.Year.ToString())"
                                                  DateFormat="MM/dd/yyyy h:mm:ss tt" Placeholder="@($"{@DateTime.Now.ToLocalTime()}")" Change="@(args => PickDateOfTime())" />


                            </div>
                        </div> *@
                    </RadzenFieldset>
                </div>
            </div>
        </div>
    </EditForm>
}

@code {
    [Parameter]
    public Guid id { get; set; }

    private NTDataHiveFrontend.Model.Feedback addFeedback = new Model.Feedback();
    private NTDataHiveFrontend.Model.Feedback feedbackDetail = new Model.Feedback();

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();

        feedbackDetail = await MyBackendService.GetFeedbackRecord(id);
    }

    private async Task Save()
    {
        await MyBackendService.SaveFeedback(feedbackDetail);

        MyNavigationManager.NavigateTo("/feedback-performance");
    }

    private void PickDateOfTime()
    {
        var value = DateTime.Now;
        feedbackDetail.TargetDateOfCompletionCA = value;
        StateHasChanged();
    }
}
